{{ $main := resources.Get "js/main.js" }}
{{ $menu := resources.Get "js/menu.js" }}
{{ $prism := resources.Get "js/prism.js" }}
{{ $theme := resources.Get "js/theme.js" }}
{{ $secureJS := slice $main $menu $prism $theme | resources.Concat "bundle.js" | resources.Minify | resources.Fingerprint "sha512" }}
<script type="text/javascript" src="{{ $secureJS.RelPermalink }}" integrity="{{ $secureJS.Data.Integrity }}"></script>

{{- if .Site.GoogleAnalytics }}
{{ template "_internal/google_analytics.html" . }}
{{- end}}

{{ range $val := $.Site.Params.customJS }}
{{ if gt (len $val) 0 }}
<script src="{{ $val }}"></script>
{{ end }}
{{ end }}

<style>
code.has-jax {
        font: inherit;
        font-size: 1.25rem;
        background: inherit;
        border: inherit;
        color: $light-color !important;                                                                                               
        .dark-theme & {                                                                                                                         
                color: $dark-color !important;
        }
}
div.has-jax {
        overflow-x: scroll;
        .scrollable-element {
                scrollbar-color: red yellow;
        }
}

</style>

<!-- From https://geoffruddock.com/math-typesetting-in-hugo/ -->
<script>
  MathJax = {
          tex: {
                  inlineMath: [['$', '$'], ['\\(', '\\)']],
                  displayMath: [['$$','$$'], ['\\[', '\\]']],
                  processEscapes: true,
                  processEnvironments: true
          },
          options: {
                  skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
          }
  };

  window.addEventListener('load', (event) => {
          document.querySelectorAll("mjx-container").forEach(function(x){
                  x.parentElement.classList += 'has-jax'})
  });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
                         src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
