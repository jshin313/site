<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="It looks like we have another EmojiASM problem! Note: Depending on what editor/browser you view this on, the emoji&amp;rsquo;s might not be shown properly. That means copying and pasting the emojis might not work well. Try using a browser.
Problem Description Impressive work. But the emojasm gods have provided you with one more foul challenge. Once again, the web interface should be above.
Info from the EmojiASM Webpage Architecture  General-purpose registers X and Y (both 8 bits wide) Accumulator Register A (8 bits wide) 3x Tape Drives, T0 T1 and T2 (descibed below), each with the following:  1 input buffer register (TnI) 1 ouput buffer register (TnO) 1 write flag (TnW)   Obviously each tape drive has a position on the tape as well, which changes as the tape gets moved." />
<meta name="keywords" content=", ctf, writeup, security" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="/posts/ractf-return_of_the_emojiasm/" />


    <title>
        
            CTF Writeup: Return of the EmojASM :: Jacob Shin  â€” A Random Site
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.5037a481170c6b709cdeb719022370673540890c54014d3d06f3338ac4f219f4.css">






<meta itemprop="name" content="CTF Writeup: Return of the EmojASM">
<meta itemprop="description" content="It looks like we have another EmojiASM problem! Note: Depending on what editor/browser you view this on, the emoji&rsquo;s might not be shown properly. That means copying and pasting the emojis might not work well. Try using a browser.
Problem Description Impressive work. But the emojasm gods have provided you with one more foul challenge. Once again, the web interface should be above.
Info from the EmojiASM Webpage Architecture  General-purpose registers X and Y (both 8 bits wide) Accumulator Register A (8 bits wide) 3x Tape Drives, T0 T1 and T2 (descibed below), each with the following:  1 input buffer register (TnI) 1 ouput buffer register (TnO) 1 write flag (TnW)   Obviously each tape drive has a position on the tape as well, which changes as the tape gets moved.">
<meta itemprop="datePublished" content="2020-06-15T21:01:15-04:00" />
<meta itemprop="dateModified" content="2020-06-15T21:01:15-04:00" />
<meta itemprop="wordCount" content="2007">
<meta itemprop="image" content="/"/>



<meta itemprop="keywords" content="ctf,writeup,security," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="CTF Writeup: Return of the EmojASM"/>
<meta name="twitter:description" content="It looks like we have another EmojiASM problem! Note: Depending on what editor/browser you view this on, the emoji&rsquo;s might not be shown properly. That means copying and pasting the emojis might not work well. Try using a browser.
Problem Description Impressive work. But the emojasm gods have provided you with one more foul challenge. Once again, the web interface should be above.
Info from the EmojiASM Webpage Architecture  General-purpose registers X and Y (both 8 bits wide) Accumulator Register A (8 bits wide) 3x Tape Drives, T0 T1 and T2 (descibed below), each with the following:  1 input buffer register (TnI) 1 ouput buffer register (TnO) 1 write flag (TnW)   Obviously each tape drive has a position on the tape as well, which changes as the tape gets moved."/>



    <meta property="og:title" content="CTF Writeup: Return of the EmojASM" />
<meta property="og:description" content="It looks like we have another EmojiASM problem! Note: Depending on what editor/browser you view this on, the emoji&rsquo;s might not be shown properly. That means copying and pasting the emojis might not work well. Try using a browser.
Problem Description Impressive work. But the emojasm gods have provided you with one more foul challenge. Once again, the web interface should be above.
Info from the EmojiASM Webpage Architecture  General-purpose registers X and Y (both 8 bits wide) Accumulator Register A (8 bits wide) 3x Tape Drives, T0 T1 and T2 (descibed below), each with the following:  1 input buffer register (TnI) 1 ouput buffer register (TnO) 1 write flag (TnW)   Obviously each tape drive has a position on the tape as well, which changes as the tape gets moved." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/ractf-return_of_the_emojiasm/" />
<meta property="og:image" content="/"/>
<meta property="article:published_time" content="2020-06-15T21:01:15-04:00" />
<meta property="article:modified_time" content="2020-06-15T21:01:15-04:00" /><meta property="og:site_name" content="Jacob Shin" />






    <meta property="article:published_time" content="2020-06-15 21:01:15 -0400 EDT" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span style="color:#98971a" class="logo__text">jacob@server:</span>
            <span style="color:#689d6a" class="logo__text">/home/site</span>
            <span style="color:#fbf1c7" class="logo__text">$ </span>
            <span class="logo__text"> </span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/projects">Projects</a></li><li><a href="/posts">Posts</a></li><li><a href="/notes">Notes</a></li><li><a href="/about">About</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>



            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>10 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title">
                <a href="/posts/ractf-return_of_the_emojiasm/">CTF Writeup: Return of the EmojASM</a>
            </h1>

            

            <div class="post-content">
                <p>It looks like we have another EmojiASM problem!
Note: Depending on what editor/browser you view this on, the emoji&rsquo;s might not be shown properly. That means copying and pasting the emojis might not work well. Try using a browser.</p>
<h2 id="problem-description">Problem Description</h2>
<p>Impressive work. But the emojasm gods have provided you with one more foul challenge. Once again, the web interface should be above.</p>
<h2 id="info-from-the-emojiasm-webpage">Info from the EmojiASM Webpage</h2>
<h3 id="architecture">Architecture</h3>
<ul>
<li>General-purpose registers X and Y (both 8 bits wide)</li>
<li>Accumulator Register A (8 bits wide)</li>
<li>3x Tape Drives, T0 T1 and T2 (descibed below), each with the following:
<ul>
<li>1 input buffer register (TnI)</li>
<li>1 ouput buffer register (TnO)</li>
<li>1 write flag (TnW)</li>
</ul>
</li>
<li>Obviously each tape drive has a position on the tape as well, which changes as the tape gets moved. (TnP)</li>
</ul>
<p>&ldquo;n&rdquo; here refers to the tape id, so for instance the input buffer register of tape 2 (T2) is known as T2I.</p>
<h3 id="tape-drive-details">Tape drive details</h3>
<p>Each tape drive supports the following operations:</p>
<ul>
<li>Forward - move the tape forward one space (and other things, described below)</li>
<li>Backward - move the tape backward one space</li>
<li>Rewind - reset the tape&rsquo;s position to 0, and clear both buffers and the write flag.</li>
<li>Set-write - write a byte to the output buffer and set the write flag.</li>
</ul>
<p>The forward operation is special because it also does the following:</p>
<ul>
<li>Reads the data in the space it has just passed over into the input buffer register</li>
<li>If the write flag is set:
<ul>
<li>Write the data in the output buffer register to the byte just passed over</li>
<li>Clear the write flag</li>
</ul>
</li>
</ul>
<p>None of those things happen when going backwards, and this is the only way to read and write to or from any tape.</p>
<p>Each tape drive is 256 bytes long. Trying to move forwards or backwards past the end of the tape has no effect.</p>
<p>Read more about EmojiASM <a href="https://gist.github.com/Bentechy66/bce063ee26bb0ec2ae664d506ed28ad0#file-emojasm_16bitjmp_spec-md">here</a>.</p>
<h2 id="approach">Approach</h2>
<p>Basically we just have to xor each byte from tape0 with a byte from tape1.
Unfortunately we EmojiASM doesn&rsquo;t have an xor instruction. All the bitwise operations we have are <code>&amp;</code> and <code>|</code>.</p>
<p>Fortunately, we can use a combination of the given operations to create something that&rsquo;s equivalent to the xor operation.
After some searching, I come across this stack overflow <a href="https://stackoverflow.com/questions/4715232/xor-from-only-or-and-and">post</a>.</p>
<p>After scrolling through the various answers, it seems like <a href="https://stackoverflow.com/a/47588032/9512643">this</a> is the easiest to implement in emojiasm.
We&rsquo;ll use this to replace xor</p>
<pre><code>a ^ b  = (a | b) - (a &amp; b)
</code></pre><h2 id="read-data-off-of-tape0-and-tape1">Read data off of Tape0 and Tape1</h2>
<p>We&rsquo;ll be using the practice mode first to make sure our asm actually works (make sure to check the &ldquo;Include debug output&rdquo; option).
First, let&rsquo;s see if we can read some of the data on tape0 and tape1.</p>
<p>Let&rsquo;s read from T1 first:</p>
<pre><code>â¡ï¸ğŸï¸             Move T1 forward        puts one character into T1I
ğŸ‘ï¸ğŸï¸            A &lt;- T1I               move the character in T1I into the Accumulator Register A
ğŸ“¤              output &lt;- chr(A)       print out what's in A
</code></pre><p>We can put all the instructions in a compact line like this <code>â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸ğŸ“¤</code>.
Let&rsquo;s see what&rsquo;s on T1 by stringing a bunch of these together:</p>
<pre><code>â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸ğŸ“¤â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸ğŸ“¤â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸ğŸ“¤â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸ğŸ“¤â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸ğŸ“¤â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸ğŸ“¤â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸ğŸ“¤â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸ğŸ“¤â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸ğŸ“¤â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸ğŸ“¤
</code></pre><p>We get the following output</p>
<pre><code>Your program has been run successfully!

The output was:

xorkeyxork
</code></pre><p>Let&rsquo;s try doing the same for T0:</p>
<pre><code>â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¤
</code></pre><p>Output:</p>
<pre><code>Your program has been run successfully!

The output was:

â½â½â½â½â½
â½
</code></pre><p>It looks like Tape0 has non ASCII characters. Let&rsquo;s add 0x30 to each character from tape0 to make them viewable.
For example, if tape0 had <code>0</code> in the first byte, we would add 0x30 before displaying it. <code>chr(0 + 0x30) = &quot;0&quot;</code>. Then we would see <code>&quot;0&quot;</code> instead of <code>â½</code>.</p>
<pre><code>â¡ï¸ğŸ“¼             Move T0 forward         Puts one byte into T0I
ğŸ‘ï¸ğŸ“¼            A &lt;- T0I                Move the byte in T0I into the Accumulator Register A
ğŸ“¦ğŸ”¨            X &lt;- A                  Put what's in A into X 
âœ‰ï¸ğŸ˜ƒğŸ˜€           A &lt;- 0x30               Puts 0x30 into A
â•ğŸ”¨            A &lt;- A + X              Adds X to A
ğŸ“¤              out &lt;- chr(A)           Outputs A
</code></pre><p>The pseudocode below is equivalenet to the above</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python3" data-lang="python3">A <span style="color:#f92672">=</span> T0I <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x30</span>
print(A)
</code></pre></div><p>Make the above emojiasm more compact: <code>â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤</code>
And string a bunch together to read tape1:</p>
<pre><code>â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼ğŸ“¦ğŸ”¨âœ‰ï¸ğŸ˜ƒğŸ˜€â•ğŸ”¨ğŸ“¤
</code></pre><p>Output:</p>
<pre><code>Your program has been run successfully!

The output was:

:&gt;AO32&lt;:1O

</code></pre><p>So the first byte on tape0 is 10 since <code>ord(&quot;:&quot;) - 0x30 = 10</code></p>
<p>Let&rsquo;s see what the first character of the flag should be by xoring the first byte from tape0 (10) with the first byte from tape1 (ord(&ldquo;x&rdquo;)):</p>
<pre><code class="language-console" data-lang="console">$ python -c 'print chr(10 ^ ord(&quot;x&quot;))'
r
</code></pre><p>As we expected, the first character of the flag is <code>r</code>.</p>
<h2 id="implement-subtraction">Implement Subtraction</h2>
<p>Now we can use <code>a ^ b  = (a | b) - (a &amp; b)</code> to implement an xor function. However, emojiasm doesn&rsquo;t have a subtract operation, only a decrement op.<br>
So we have to first create a way to subtract before we make implement xor.</p>
<p>The following code subtracts 0x02 from 0x43 and stores the result in T2:</p>
<pre><code>01: âœ‰ï¸ğŸ˜„ğŸ˜ƒ               A &lt;- 0x43 
02: âœï¸ğŸ¥                 T2O &lt;- A
03: â¡ï¸ğŸ¥                 T2 &lt;- T2O
04: T2[0] = 0x43
05:
06: âœ‰ï¸ğŸ˜€ğŸ˜‚               A &lt;- 0x02
07: ğŸ“¦ğŸ”¨                X &lt;- A
08: X = 0x2
09: 
10: âœ‰ï¸ğŸ˜€ğŸ˜€               A &lt;- 0
11: ğŸ“¦â›ï¸                 Y &lt;- A
12: Y = 0
13: 
14: âªğŸ¥                Rewind T2
15: â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥             A &lt;- T2               
16: ğŸ¦”ğŸ—ƒï¸                A &lt;- A - 1
17: âªğŸ¥                Rewind T2
18: âœï¸ğŸ¥                 T2O &lt;- A
19: â¡ï¸ğŸ¥                 T2 &lt;- T2O
20: A = T2[0]
21: A -= 1
22: T2[0] = A
23: 
24: ğŸ’¡â›ï¸                 Y &lt;- Y + 1
25: ğŸâ›ï¸                 A &lt;- Y
26: â“ğŸ”¨                flags â† cmp(X, A)
27: ğŸ‡ğŸ˜€ğŸ˜€ğŸ˜ğŸ˜…          RJMP &lt;- value
28: ğŸ·ï¸                  {if flags.EQ not set} PC â† RJMP
29: Y += 1
30: if y != A:
31:     goto 14
</code></pre><p>An uncommented version of the above:</p>
<pre><code>âœ‰ï¸ğŸ˜„ğŸ˜ƒ
âœï¸ğŸ¥
â¡ï¸ğŸ¥
âœ‰ï¸ğŸ˜€ğŸ˜‚
ğŸ“¦ğŸ”¨
âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥
ğŸ¦”ğŸ—ƒï¸
âªğŸ¥
âœï¸ğŸ¥
â¡ï¸ğŸ¥
ğŸ’¡â›ï¸
ğŸâ›ï¸
â“ğŸ”¨
ğŸ‡ğŸ˜€ğŸ˜€ğŸ˜ğŸ˜…
ğŸ·ï¸
</code></pre><p>Let&rsquo;s run the above asm:</p>
<pre><code>Your program has been run successfully!

The output was:


--Debug output

1-4: OP.LDA with args: ['ğŸ˜„', 'ğŸ˜ƒ']
6-8: OP.TOUT with args: ğŸ¥
10-12: OP.TF with args: ğŸ¥
14-17: OP.LDA with args: ['ï¿½', 'ğŸ˜‚']
18-20: OP.TAR with args: ğŸ”¨
21-23: OP.TRW with args: ğŸ¥
25-27: OP.TF with args: ğŸ¥
28-30: OP.TIN with args: ğŸ¥
31-34: OP.DEC with args: ğŸ—ƒï¸
35-37: OP.TRW with args: ğŸ¥
39-41: OP.TOUT with args: ğŸ¥
43-45: OP.TF with args: ğŸ¥
46-49: OP.INC with args: â›ï¸
50-53: OP.TRA with args: â›ï¸
54-56: OP.CMP with args: ğŸ”¨
57-62: OP.LDJMP with args: ['ï¿½', 'ï¿½', 'ğŸ˜', 'ğŸ˜…']
[OP.LDJMP] - Setting RJMP to 21 for ldjmp [0x0, 0x0, 0x1, 0x5]
64-65: OP.JMPNEQ with args: None
[OP.JMPNEQ] - Setting PC to 21
21-23: OP.TRW with args: ğŸ¥
25-27: OP.TF with args: ğŸ¥
28-30: OP.TIN with args: ğŸ¥
31-34: OP.DEC with args: ğŸ—ƒï¸
35-37: OP.TRW with args: ğŸ¥
39-41: OP.TOUT with args: ğŸ¥
43-45: OP.TF with args: ğŸ¥
46-49: OP.INC with args: â›ï¸
50-53: OP.TRA with args: â›ï¸
54-56: OP.CMP with args: ğŸ”¨
57-62: OP.LDJMP with args: ['ï¿½', 'ï¿½', 'ğŸ˜', 'ğŸ˜…']
[OP.LDJMP] - Setting RJMP to 21 for ldjmp [0x0, 0x0, 0x1, 0x5]
64-65: OP.JMPNEQ with args: None
Halting (pc: 65, maxidx: 64)
</code></pre><blockquote>
<p>Jumping:
Program memory offsets are the number of characters (unicode codepoints) from the start of the file. This takes into account emojis that are actually multiple codepoints, so beware.</p>
</blockquote>
<p>If you have any problems or errors running the above code, make sure to remove any extraneous spaces. Any extra character will throw the jump offset off (see the above quote). Here we set the jump to 21 since the first OP.TRW (rewind) instruction is at 21.
If you have extra spaces or extra characters, you might need to adjust the offset to whereever the first rewind instruction is.</p>
<pre><code>âªğŸ¥                Rewind tape2
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥             A &lt;- one chr of tape2
ğŸ“¤                  out &lt;- chr(A)
</code></pre><p>The full subtraction code with output:</p>
<pre><code>âœ‰ï¸ğŸ˜„ğŸ˜ƒ
âœï¸ğŸ¥
â¡ï¸ğŸ¥
âœ‰ï¸ğŸ˜€ğŸ˜‚
ğŸ“¦ğŸ”¨
âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥
ğŸ¦”ğŸ—ƒï¸
âªğŸ¥
âœï¸ğŸ¥
â¡ï¸ğŸ¥
ğŸ’¡â›ï¸
ğŸâ›ï¸
â“ğŸ”¨
ğŸ‡ğŸ˜€ğŸ˜€ğŸ˜ğŸ˜…
ğŸ·ï¸
âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥  
ğŸ“¤
</code></pre><p>Output:</p>
<pre><code>Your program has been run successfully!
The output was:
A
</code></pre><p>The program prints out <code>A</code>, which is the expected result since 0x43 - 2 = 0x41 and chr(0x41) = &ldquo;A&rdquo;.</p>
<h2 id="implement-xor">Implement XOR</h2>
<p>Now that our test subtraction program works, we use it to implement xor.
We&rsquo;ll basically use the following forumla and imlement that: a ^ b  = (a | b) - (a &amp; b)
Note: In the pseudocode below, <code>i</code> is just the current index or current position on the tape
When the program first starts, the i = 0, since the program starts at the beginning of each tape.
Everytime we read, i is incremented since the position on the tape is also incremented.</p>
<pre><code>01: â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼                     A &lt;- one chr of tape0
02: ğŸ“¦ğŸ”¨                        X &lt;- A
03: â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸                     A &lt;- one chr of tape1
04: ğŸ·ğŸ”¨                        A &lt;- A | X
05: âªğŸ¥                        Rewind Tape2
06: âœï¸ğŸ¥                         T2O &lt;- A
07: â¡ï¸ğŸ¥                         T2 &lt;- T2O (output buf of T2)
08: T2[0] = tape1[i] | tape0[i]
09: 
10: â¬…ï¸ğŸ“¼â¬…ï¸ğŸï¸                      Move T1 and T0 backwards by 1 since reading from the tapes moves the position forward
11: â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼                     A &lt;- one chr of tape0
12: ğŸ“¦ğŸ”¨                        X &lt;- A
13: â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸                     A &lt;- one chr of tape1
14: ğŸ´ğŸ”¨                        A &lt;- A &amp; X
15: ğŸ“¦ğŸ”¨                        X &lt;- A
16: âœ‰ï¸ğŸ˜€ğŸ˜€                       A &lt;- 0
17: ğŸ“¦â›ï¸                         Y &lt;- A
18: X = T1[i] &amp; T0[i]
20: Y = 0
21: 
22: âªğŸ¥                        Rewind T2
23: â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥                     A &lt;- T2               
24: ğŸ¦”ğŸ—ƒï¸                        A &lt;- A - 1
25: âªğŸ¥                        Rewind T2
26: âœï¸ğŸ¥                         T2O &lt;- A
27: â¡ï¸ğŸ¥                         T2 &lt;- T2O
28: A = T2[0]
29: T2[0] = A - 1
30: 
31: ğŸ’¡â›ï¸                         Y &lt;- Y + 1
32: ğŸâ›ï¸                         A &lt;- Y
33: â“ğŸ”¨                        flags â† cmp(X, A)
34: ğŸ‡ğŸ˜€ğŸ˜€                  RJMP &lt;- value
35: ğŸ·ï¸                          {if flags.EQ not set} PC â† RJMP
36: Y += 1
37: if X != Y:
38:     goto 22
</code></pre><p>Uncommented version of above:</p>
<pre><code>â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼
ğŸ“¦ğŸ”¨
â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸
ğŸ·ğŸ”¨
âªğŸ¥
âœï¸ğŸ¥
â¡ï¸ğŸ¥
â¬…ï¸ğŸ“¼â¬…ï¸ğŸï¸
â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼
ğŸ“¦ğŸ”¨
â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸
ğŸ´ğŸ”¨
ğŸ“¦ğŸ”¨
âœ‰ï¸ğŸ˜€ğŸ˜€
ğŸ“¦â›ï¸
âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥
ğŸ¦”ğŸ—ƒï¸
âªğŸ¥
âœï¸ğŸ¥
â¡ï¸ğŸ¥
ğŸ’¡â›ï¸
ğŸâ›ï¸
â“ğŸ”¨
ğŸ‡ğŸ˜€ğŸ˜€ğŸ˜„ğŸ˜‹
ğŸ·ï¸
</code></pre><p>Just like in the subtraction program, we set the jump offset to where the first rewind instruction is (OP.TRW) which in this case is 75 or 0x4b.</p>
<p>Now let&rsquo;s make sure the program is actually working by printing out the first byte in T2. We&rsquo;ll use this code snippet from earlier to print out the first byte of T2:</p>
<pre><code>âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥  
ğŸ“¤
</code></pre><p>Now combine the output code with the xor implementation:</p>
<pre><code>â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼
ğŸ“¦ğŸ”¨
â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸
ğŸ·ğŸ”¨
âªğŸ¥
âœï¸ğŸ¥
â¡ï¸ğŸ¥
â¬…ï¸ğŸ“¼â¬…ï¸ğŸï¸
â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼
ğŸ“¦ğŸ”¨
â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸
ğŸ´ğŸ”¨
ğŸ“¦ğŸ”¨
âœ‰ï¸ğŸ˜€ğŸ˜€
ğŸ“¦â›ï¸
âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥
ğŸ¦”ğŸ—ƒï¸
âªğŸ¥
âœï¸ğŸ¥
â¡ï¸ğŸ¥
ğŸ’¡â›ï¸
ğŸâ›ï¸
â“ğŸ”¨
ğŸ‡ğŸ˜€ğŸ˜€ğŸ˜„ğŸ˜‹
ğŸ·ï¸
âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥  
ğŸ“¤
</code></pre><p>Ouput</p>
<pre><code>Your program has been run successfully!

The output was:

r
</code></pre><p>We&rsquo;ve got the first letter of the flag!
Now all we have to do is copy and paste the above code snippet about 4 times:</p>
<pre><code>â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼
ğŸ“¦ğŸ”¨
â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸
ğŸ·ğŸ”¨
âªğŸ¥
âœï¸ğŸ¥
â¡ï¸ğŸ¥
â¬…ï¸ğŸ“¼â¬…ï¸ğŸï¸
â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼
ğŸ“¦ğŸ”¨
â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸
ğŸ´ğŸ”¨
ğŸ“¦ğŸ”¨
âœ‰ï¸ğŸ˜€ğŸ˜€
ğŸ“¦â›ï¸
âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥
ğŸ¦”ğŸ—ƒï¸
âªğŸ¥
âœï¸ğŸ¥
â¡ï¸ğŸ¥
ğŸ’¡â›ï¸
ğŸâ›ï¸
â“ğŸ”¨
ğŸ‡ğŸ˜€ğŸ˜€ğŸ˜„ğŸ˜‹
ğŸ·ï¸
âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥  
ğŸ“¤

â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼
ğŸ“¦ğŸ”¨
â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸
ğŸ·ğŸ”¨
âªğŸ¥
âœï¸ğŸ¥
â¡ï¸ğŸ¥
â¬…ï¸ğŸ“¼â¬…ï¸ğŸï¸
â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼
ğŸ“¦ğŸ”¨
â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸
ğŸ´ğŸ”¨
ğŸ“¦ğŸ”¨
âœ‰ï¸ğŸ˜€ğŸ˜€
ğŸ“¦â›ï¸
âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥
ğŸ¦”ğŸ—ƒï¸
âªğŸ¥
âœï¸ğŸ¥
â¡ï¸ğŸ¥
ğŸ’¡â›ï¸
ğŸâ›ï¸
â“ğŸ”¨
ğŸ‡ğŸ˜€ğŸ˜€ğŸ˜„ğŸ˜‹
ğŸ·ï¸
âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥  
ğŸ“¤

â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼
ğŸ“¦ğŸ”¨
â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸
ğŸ·ğŸ”¨
âªğŸ¥
âœï¸ğŸ¥
â¡ï¸ğŸ¥
â¬…ï¸ğŸ“¼â¬…ï¸ğŸï¸
â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼
ğŸ“¦ğŸ”¨
â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸
ğŸ´ğŸ”¨
ğŸ“¦ğŸ”¨
âœ‰ï¸ğŸ˜€ğŸ˜€
ğŸ“¦â›ï¸
âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥
ğŸ¦”ğŸ—ƒï¸
âªğŸ¥
âœï¸ğŸ¥
â¡ï¸ğŸ¥
ğŸ’¡â›ï¸
ğŸâ›ï¸
â“ğŸ”¨
ğŸ‡ğŸ˜€ğŸ˜€ğŸ˜„ğŸ˜‹
ğŸ·ï¸
âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥  
ğŸ“¤

â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼
ğŸ“¦ğŸ”¨
â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸
ğŸ·ğŸ”¨
âªğŸ¥
âœï¸ğŸ¥
â¡ï¸ğŸ¥
â¬…ï¸ğŸ“¼â¬…ï¸ğŸï¸
â¡ï¸ğŸ“¼ğŸ‘ï¸ğŸ“¼
ğŸ“¦ğŸ”¨
â¡ï¸ğŸï¸ğŸ‘ï¸ğŸï¸
ğŸ´ğŸ”¨
ğŸ“¦ğŸ”¨
âœ‰ï¸ğŸ˜€ğŸ˜€
ğŸ“¦â›ï¸
âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥
ğŸ¦”ğŸ—ƒï¸
âªğŸ¥
âœï¸ğŸ¥
â¡ï¸ğŸ¥
ğŸ’¡â›ï¸
ğŸâ›ï¸
â“ğŸ”¨
ğŸ‡ğŸ˜€ğŸ˜€ğŸ˜„ğŸ˜‹
ğŸ·ï¸
âªğŸ¥
â¡ï¸ğŸ¥ğŸ‘ï¸ğŸ¥  
ğŸ“¤
</code></pre><p>Output</p>
<pre><code>Your program has been run successfully!

The output was:

ractf{testing_flag}
The expected output was:

ractf{testingflag}
This was a match.
</code></pre><p>We&rsquo;ve got the whole flag!
Running the code just 4 times is able to produce the whole flag since the jump offset is constant at 75, which means that after we execute the 1st block, we&rsquo;ll loop to the beginning.</p>
<p>Runnning the above code on the actual challenge works and gives us the real flag.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="/tags/ctf">ctf</a></span><span class="tag"><a href="/tags/writeup">writeup</a></span><span class="tag"><a href="/tags/security">security</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>2007 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2020-06-15 21:01 -0400</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h">Read other posts</span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="/posts/ractf-solved_in_a_flash/">
                                <span class="button__icon">â†</span>
                                <span class="button__text">CTF Writeup: Solved in a Flash</span>
                            </a>
                        </span>
                    

                    
                        <span class="button next">
                            <a href="/posts/castorsctf-babybof1pt2/">
                                <span class="button__text">CTF Writeup: Babybof1 Pt2</span>
                                <span class="button__icon">â†’</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        
        <script src="https://utteranc.es/client.js"
                repo="jshin313/site"
                issue-term="pathname"
                label="comment"
                theme="github-dark"
                crossorigin="anonymous"
                async>
        </script>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span style="color:#98971a">&copy; 2020</span>
            
            
                <span style="color:#98971a">Jacob Shin</span>
            
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <h5><a href="http://gohugo.io">Hugo</a></h5>
            <h5><a href="https://github.com/morhetz/gruvbox">Gruvbox (Sort of)</a></h5>
            <h5><a href="https://github.com/rhazdon">Theme</a></h5>
        </div>
    </div>
</footer>

<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>


            
        </div>

        




<script type="text/javascript" src="/bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js" integrity="sha512-3HFukJLJggt3&#43;W2ilNASCu6xibW86pdSMJ6&#43;on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script>



    </body>
</html>
